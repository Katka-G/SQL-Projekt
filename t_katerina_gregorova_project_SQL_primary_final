CREATE TABLE t_katerina_gregorova_project_SQL_primary_final AS
	SELECT
		cpay.payroll_year,
		cpc.name AS food_category,
		ROUND(AVG(cp.value)::NUMERIC, 2) AS annual_average_price,
		cpc.price_value,
		cpc.price_unit,
		cpib.name AS industry,
		ROUND(AVG(cpay.value)::NUMERIC, 2) AS annual_average_salary
	FROM
		czechia_price AS cp 
	JOIN 
		czechia_payroll AS cpay
		ON DATE_PART('year', cp.date_from) = cpay.payroll_year
		AND cpay.value_type_code = 5958   -- podmínku ideálně přesunout do WHERE (před GROUP BY)!!
	JOIN 
		czechia_price_category AS cpc
		ON cp.category_code = cpc.code
	JOIN 
		czechia_payroll_industry_branch AS cpib    
		ON cpay.industry_branch_code = cpib.code
	GROUP BY
		cpay.payroll_year,
		cpc.name,
		cpc.price_value,
		cpc.price_unit,
		cpib.name;
